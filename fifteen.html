<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>15 Puzzle Game</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
    }

    #puzzle-container {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      gap: 5px;
    }

    .tile {
      width: 100px;
      height: 100px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      font-weight: bold;
      background-color: #ddd;
      cursor: pointer;
      user-select: none;
    }

    .empty {
      background-color: #fff;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div id="puzzle-container"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const gridSize = 4;
      const totalTiles = gridSize * gridSize - 1; // 15 tiles + 1 empty space
      let isSolved = false;

      // Function to create the puzzle grid
      function createPuzzleGrid() {
        const container = document.getElementById('puzzle-container');
        container.innerHTML = '';

        const numbers = Array.from({ length: totalTiles }, (_, i) => i + 1);

        shuffle(numbers);

        for (let i = 0; i < totalTiles; i++) {
          const tile = document.createElement('div');
          tile.classList.add('tile');
          tile.textContent = numbers[i];
          tile.addEventListener('click', () => handleTileClick(i + 1)); // i + 1 to match tile value
          container.appendChild(tile);

          if (i === totalTiles - 1) {
            tile.classList.add('empty');
          }
        }

        document.addEventListener('keydown', handleKeyDown);
        isSolved = false;
      }

      // Function to shuffle the numbers
      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
      }

      // Function to handle tile clicks
      function handleTileClick(tileValue) {
        if (!isSolved) {
          const emptyTile = document.querySelector('.empty');
          const emptyIndex = getIndex(emptyTile);

          const clickedTile = document.querySelector(`.tile[data-value="${tileValue}"]`);
          const clickedIndex = getIndex(clickedTile);

          if (isAdjacent(emptyIndex, clickedIndex)) {
            swapTiles(emptyTile, clickedTile);
            checkWin();
          }
        }
      }

      // Function to handle key presses
      function handleKeyDown(event) {
        if (!isSolved) {
          const emptyTile = document.querySelector('.empty');
          const emptyIndex = getIndex(emptyTile);

          let newIndex;

          switch (event.key) {
            case 'ArrowUp':
              newIndex = emptyIndex + gridSize;
              break;
            case 'ArrowDown':
              newIndex = emptyIndex - gridSize;
              break;
            case 'ArrowLeft':
              newIndex = emptyIndex + 1;
              break;
            case 'ArrowRight':
              newIndex = emptyIndex - 1;
              break;
            default:
              return;
          }

          const newTile = document.querySelector(`.tile:nth-child(${newIndex + 1})`);

          if (newTile) {
            swapTiles(emptyTile, newTile);
            checkWin();
          }
        }
      }

      // Function to get the index of a tile
      function getIndex(tile) {
        const tiles = document.querySelectorAll('.tile');
        return Array.from(tiles).indexOf(tile);
      }

      // Function to check if two tiles are adjacent
      function isAdjacent(index1, index2) {
        const row1 = Math.floor(index1 / gridSize);
        const col1 = index1 % gridSize;
        const row2 = Math.floor(index2 / gridSize);
        const col2 = index2 % gridSize;

        return Math.abs(row1 - row2) + Math.abs(col1 - col2) === 1;
      }

      // Function to swap two tiles
      function swapTiles(tile1, tile2) {
        [tile1.textContent, tile2.textContent] = [tile2.textContent, tile1.textContent];
        [tile1.classList, tile2.classList] = [tile2.classList, tile1.classList];
      }

      // Function to check if the puzzle is solved
      function checkWin() {
        const tiles = document.querySelectorAll('.tile');
        const values = Array.from(tiles).map(tile => parseInt(tile.textContent));
        const sortedValues = [...values].sort((a, b) => a - b);

        if (JSON.stringify(values) === JSON.stringify(sortedValues)) {
          alert('Congratulations! You solved the puzzle!');
          isSolved = true;
        }
      }

      // Initial puzzle creation
      createPuzzleGrid();
    });
  </script>
</body>
</html>
